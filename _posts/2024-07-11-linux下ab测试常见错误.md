---
layout: post
title: "linux下ab测试常见错误"
category: Linux
tags: Linux ab
date: 2024-07-11 11:00
---

### 最近做压力测试比较多，常用jmeter，ab等工具，记录下遇到问题及解决方式

- 出现apr_pollset_poll: The timeout specified has expired (70007)

如果出现apr_pollset_poll: The timeout specified has expired (70007)，主要是timeout连接超时了，可以加个 ***-k参数***，让连接KeepAlive

#### ab -c 100 -n 1000 -k http://127.0.0.1:5000

- 出现apr_socket_recv: Connection reset by peer (104)

如果出现apr_socket_recv: Connection reset by peer (104), 主要是网络存在问题，使用 ***-r参数*** 跳过忽略这种错误

#### ab -c 100 -n 1000 -r http://127.0.0.1:5000


### PS
1. 若测试为python 项目，如flask ，使用gunicorn启动，那么可以加 ***--timeout 时间参数(s)*** 增加timeout超时时间 参数
2. linux 下可临时设置连接数(当前session下)

```

ulimit -n 查看当前链接，默认1024

ulimit -n 10000 设置1w

```
